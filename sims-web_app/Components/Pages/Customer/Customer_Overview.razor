@page "/Customer_Overview"
@using RestSharp;
@using System.Text.Json;
@using sims_web_app.Data.Model
@using sims_web_app.Data.Model.Enum
@using sims_web_app.Services

<PageTitle>Manage Customer</PageTitle>

<MudText Typo="Typo.h3" GutterBottom="true">Manage Customer</MudText>
<MudText Typo="Typo.body1" Class="mb-8">..............</MudText>

<NavLink href="/Add_Customer"><MudButton Variant="Variant.Filled" DropShadow="false" Color="Color.Primary">Add Customer</MudButton></NavLink>

@if (customer == null)
{
    <MudProgressCircular Color="Color.Default" Indeterminate="true" />
}
else
{
    <MudTable Items="customer" Hover="true" SortLabel="Sort By" Elevation="0" AllowUnsorted="false">
        <HeaderContent>
            <MudTh></MudTh>
            <MudTh><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<CustomerOverview, object>(x => x.Id)">Customer ID</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<CustomerOverview, object>(x => x.CompanyName)">Company Name</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<CustomerOverview, object>(x => x.Email)">Email</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<CustomerOverview, object>(x => x.PhoneNumber!)">Phone Number</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<CustomerOverview, object>(x => x.Address)">Address</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<CustomerOverview, object>(x => x.City)">City</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<CustomerOverview, object>(x => x.State)">State</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<CustomerOverview, object>(x => x.ZipCode)">Zip Code</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel SortBy="new Func<CustomerOverview, object>(x => x.Country)">Country</MudTableSortLabel></MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="Enabled"><MudCheckBox T="bool" Checked="@context.selected" ValueChanged="@(e => UpdateRecord(context, e))"></MudCheckBox></MudTd>
            <MudTd DataLabel="Id"><MudLink Href="Customer">@context.Id</MudLink></MudTd>
            <MudTd DataLabel="CompanyName">@context.CompanyName</MudTd>
            <MudTd DataLabel="Email">@context.Email</MudTd>
            <MudTd DataLabel="PhoneNumber">@context.PhoneNumber</MudTd>
            <MudTd DataLabel="Address">@context.Address</MudTd>
            <MudTd DataLabel="City">@context.City</MudTd>
            <MudTd DataLabel="State">@context.State</MudTd>
            <MudTd DataLabel="ZipCode">@context.ZipCode</MudTd>
            <MudTd DataLabel="Country">@context.Country</MudTd>
        </RowTemplate>
        <PagerContent>
            <MudTablePager PageSizeOptions="new int[] { 50, 100 }" />
        </PagerContent>
    </MudTable>

}

@code {
    public bool Basic_CheckBox1 { get; set; } = true;
    private CustomerOverview[]? customer;

    protected override async Task OnInitializedAsync()
    {
       /*
        //values from database
        customer = new Customer[2];
        customer[0] = new Customer();
        customer[0].Id = "C-001";
        customer[0].CompanyName = "USTP";
        customer[0].Email = "is241305@ustp-students.at";
        customer[0].PhoneNumber = "is241305@ustp-students.at";
        customer[0].Address = "1";
        customer[0].City = "St.Pölten";
        customer[0].State = "NÖ";
        customer[0].ZipCode = "1111";
        customer[0].Country = "Austria";


        customer[1] = new Customer();
        customer[1].Id = "IS002";
        customer[1].CompanyName = "Philipp Muehlparzer ";
        customer[1].Email = "Admin";
        customer[1].PhoneNumber = "....";
        customer[1].Address = "Admin";
        customer[1].City = "Admin";
        customer[1].State = "Admin";
        customer[1].ZipCode = "Admin";
        customer[1].Country = "Admin";
        */
       
    }

    private async Task UpdateRecord(CustomerOverview record, bool ischecked)
    {
        record.selected = ischecked;

    }
}
